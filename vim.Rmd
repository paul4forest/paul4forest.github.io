---
title: "Vim Commands"
output: 
  html_document: 
    toc: yes
    toc_float: true
---

This page is the continuation of [my blog post on Vim commands](https://paulremote.blogspot.de/2014/07/vim-commands.html).


# Help

    :help  -  vim help
    :help commandname - help on a particular command
    CTRL+] - jump to a highlighted topic
    CTRL+T - jump backwards

[HTML version of the Vim help pages](http://vimhelp.appspot.com/)
kept up-to-date automatically from the 
[Vim source repository](https://github.com/vim/vim).

# Enter commands, save and quit

To enter edit mode:

    i

To enter command mode:

    escape

To exit vim, go in command mode and enter the following command:

    :q

To exit without saving the content of the file:

    :q!

To save the content of the file:

    :w

If you accidentally press CTRL+S the [terminal will hang](https://askubuntu.com/a/264253/315347)
Press `CTRL+Q` to regain control.
See also [Ctrl-s hang terminal emulator?](https://unix.stackexchange.com/questions/72086/ctrl-s-hang-terminal-emulator)
which provides a workaround: entering `stty -ixon` in .bashrc. 

To save content and exit:

    :wq

# Navigating 
## Motion

In command mode, the following motions are activated:

    :help left-right-motion
    j,k move up down
    h,l move left right
    b,w move previous or next word
    ctrl+b, ctrl+d move page up or page down
    {number} G go to line number 

Note on motion with wrapped lines:
[Move cursor by display lines when wrapping](https://vim.fandom.com/wiki/Move_cursor_by_display_lines_when_wrapping)

## Search
    "/" to search, then n forward and N backwards
    "*" to search for the word under the cursor (you can also create a mapping to search for a selected text)

### Markdown
Display a list of first level header in a markdown document (found in quick markdown navigation/TOC)

    :g/^# /#

Then enter `:line number` to jump to that line.

Thoughtbot.com [Wrap existing block of text to 80 characters](https://thoughtbot.com/blog/wrap-existing-text-at-80-characters-in-vim):

    :set textwidth=80

Apply automatically to markdown files, by adding this to .vimrc 

    au BufRead,BufNewFile *.md setlocal textwidth=80

To format the text, select it with v and up or down movements, and press 

    gq

## Line numbers
 Display line numbers

    :set nu

Disable line numbers

    :set nonu

## Working directory

Display the present working directory

    :pwd

[Set working directory to the current file](http://vim.wikia.com/wiki/Set_working_directory_to_the_current_file) (for all windows):

    :cd %:p:h

Set working directory to the current file, for the current window only

    :lcd %:p:h

In these commands, % gives the name of the current file, %:p gives its full path, and %:p:h gives its directory (the "head" of the full path). 

Automatically change the working directory to the file currently edited

    set autochdir

# Configure vim in .vimrc
See also my vimrc file stored in [setup/.vimrc](setup/.vimrc).

Reload the configuration after editing it: 

    :so ~/.vimrc

Text colour.
Add syntax highlight to your .vimrc

    syntax enable

How to add a file extension to vim syntax highlight

    au BufNewFile,BufRead *.dump set filetype=sql

I used it to display markdown files as text files:

    au BufNewFile,BufRead *.md set filetype=txt

# Editing
## Undo redo

    u: undo last change (can be repeated to undo preceding commands)
    Ctrl-R: Redo changes which were undone (undo the undos). 
    Compare to '.' to repeat a previous change, at the current cursor position. Ctrl-R will redo a previously undone change, wherever the change occurred. 

## Switch between navigation and editing mode

    A - move to the end of the line and switch to editing mode 
    I - switch to editing mode at the current place
    Escape - switch to navigation mode
    alt+h alt+j alt+k alt+l - switch to navigation mode and move
    alt+: - switch to navigation mode and send a command

## Replace characters

Vim wiki on search and replace 
Find each occurrence of 'red' (in the current line only), and replace it with 'green':
    
    :s/red/green/g

The `s`command  means "substitute".
The `g` means "greedy", it will replace all occurences of the word on a line 
(not just the first occurence).

When [text is visually selected](http://vim.wikia.com/wiki/Search_and_replace_in_a_visual_selection),
press : to enter a command. The command line will automatically enter the range:

    :'<,'>

Then you can enter a replacement command such as `s/red/green/g` 
to replace each occurence of "red" with "green" 
in all lines of the visual selection. The command will appear as:

    :'<,'>s/red/green/g

Find each occurrence of 'red' in all lines (`%s`), and replace it with 'green'.

    :%s/red/green/g 

Find each occurence of foo but don't perform the replacement, only count the number of occurences

    :%s/foo/bar/n

To replace by a new line character, use \r instead of \n.
For example to insert a new line after each comma in a selection:

    :'<,'>s/,/,\r/g

You can use replacement to remove text. 
For example to [remove the last 2 characters of each line in a selection](https://stackoverflow.com/a/36264759/2641825):

    :'<,'>s/..$//

Remove all beginnings of line. :%s/\option\n/, /g replace all end of line by comma + space. This cleans an html list of species for inclusion in a text.

    %s/option value=".*"//g 

## Editing a whole line

    dd to delete a whole line
    yy to copy a whole line
    p to paste the copied or deleted text after the current line or 
    P to paste the copied or deleted text before the current line 

## Editing multiple lines

You can edit multiple lines simultaneously by 
[inserting text inside a multi-line selection in Vim](https://stackoverflow.com/a/253391) :

    Use Ctrl+V to enter visual block mode
    Move down with jj to select the columns of text in the lines you want to comment.
    Then hit Shift+I and type the text you want to insert.
    Then press Escape, the inserted text will appear on all lines.
    
Similarly to enter text at the end of multiple lines ([vim.wikia](http://vim.wikia.com/wiki/Inserting_text_in_multiple_lines))

    Use Ctrl+V to enter visual block mode
    Move down with jj to select the columns of text in the lines you want to comment.
    Then hit $ to select all lines until the end of the line.
    Then press Shift+A and type the text you want to insert.
    The press Escape, the inserted text will appear at the end of all lines.

## Copy, cut and paste

    Position the cursor where you want to begin cutting.
    Press v (or upper case V if you want to cut whole lines).
    Move the cursor to the end of what you want to cut.
    Press d to cut or y to copy.
    Move to where you would like to paste.
    Press P to paste before the cursor, or p to paste after. 

[Paste without autoindent](https://stackoverflow.com/a/2545242/2641825)

    :r! cat 

And then paste `CTRL + SHIFT + V` the content, and `CTRL+D`.

Also works over SSH.

## Indentation

Indentation replaced by spaces, add this to the ~/.vimrc file

    set tabstop=4
    set expandtab
    set softtabstop=4
    set shiftwidth=4
    filetype indent on 

More details on vim indentation in the python wiki.

## Repeat Commands

[Repeating commands, Vim scripts and debugging](http://vimhelp.appspot.com/repeat.txt.html)

# Multiple files and windows

    :e filename - edit another file 
    :ls         - show current buffers
    :b 2        - open buffer #2 in this window
    :b filename - open buffer #filename in this window
    :bd         - close the current buffer (! to forget changes)
    :bd filename -close a buffer by name 

## Window split

    :sp[lit] filename  - split window and load another file
    :10sp - specify the split height with a number
    :vs[plit] - same but split vertically  
    ctrl-w up arrow - move cursor up a window
    ctrl-w ctrl-w   - move cursor to another window (cycle)
    ctrl-w_         - maximize current window
    ctrl-w=         - make all equal size
    CTRL+z - suspend the process and get back to the shell
    fg - get back to vim

[Easier split navigations](https://robots.thoughtbot.com/vim-splits-move-faster-and-more-naturally#easier-split-navigations)

    nnoremap <C-J> <C-W><C-J>
    nnoremap <C-K> <C-W><C-K>
    nnoremap <C-L> <C-W><C-L>
    nnoremap <C-H> <C-W><C-H> 

Natural split opening

    set splitbelow
    set splitright

## Vim and Tmux

[vim-tmux-navigator to use tmux prefix instead of C-[hjkl]](https://superuser.com/questions/1467829/vim-tmux-navigator-to-use-tmux-prefix-instead-of-c-hjkl)

# Plugins

Potentially usefull plugins

 * Fuzzy search 
 * File explorer
 * [Vimtex](https://github.com/lervag/vimtex#alternatives) 
   vim plugin for editing LaTeX files. 


## Plugins for python programming

* [Jedi](https://github.com/davidhalter/jedi)
* Plug-in [Jupyter vim](https://github.com/jupyter-vim/jupyter-vim)
* Vim on Python wiki (set softtabstop=4) or your  python development environment (set tabstop=4 and set softtabstop=4)
* [Vim and python a match made in heaven](https://realpython.com/vim-and-python-a-match-made-in-heaven/)

## Plugins for R programming 

Vim R

# Programming with vim

## Running code

SO [Running python code in VIM](https://stackoverflow.com/questions/18948491/running-python-code-in-vim)
Make sure your files start with a shebang.

# Tools

## Shell

[Working with external commands](https://www.linux.com/learn/vim-tips-working-external-commands)
explains how to start a shell:

    :shell

Then exit the shell normaly with `exit`.

Use a Bang! to run a command directly, for example to
see how many words are in the file, run:

    :! wc %

You can copy (`y $`) and paste a command in the vim command line with `CTRL + R + "`.

Insert text from a specified file into the current buffer:

    :r textfile

You can also read in the output of shell applications. For example, if you wanted to include a list of files from a specific directory, you could include them using this read command:

    :r ! ls -1 /home/user/directory

## Vim diff

View differences between `file1` and `file2` (vim documentation)

    vimdiff file1 file2

## spell check

[How to configure vim spellcheck to use two languages](https://superuser.com/questions/911412/how-to-configure-vim-spellcheck-to-use-two-languages)
To use the spellcheck for two languages, add this to your `~/.vimrc`:

    set spell spelllang=en_gb,fr

On the first use, vim may give a warning that some word lists are missing. 
[How to make vim download missing word lists](https://www.monolune.com/how-to-make-vim-download-missing-word-lists/)
To solve this issue, turn spell check off

    :set nospell 

Turn spell check on

    :set spell

Then vim will offer to download the missing dictionaries. 

Set spell check only in the local buffer:

    :setlocal spell spelllang=en_gb   

Find alternative for highlighted word:

    z=

Mark word as correct, this creates a spell file under /home/user/.vim/spell:

    zg 

Mark word as incorrect

    zw



# blogs

[Why atom cant replace vim](https://medium.com/@mkozlows/why-atom-cant-replace-vim-433852f4b4d1)

> "This philosophy of minimalist commands that can be composed together is the
> fundamental originating philosophy of Unix, and Vim exemplifies it like no
> other editor."

[Python workflow with terminal using tmux](https://www.reddit.com/r/vim/comments/chdl60/python_workflow_with_terminal_using_tmux/)

[Jupyter vim](https://github.com/jupyter-vim/jupyter-vim)
[Browse the web in vim mode](https://github.com/tridactyl/tridactyl)

## Learning vim
* [Should I introduce vim tomy kid](https://www.reddit.com/r/vim/comments/aak1lf/should_i_introduce_vim_to_my_kid/)
> "Learn to support, not to shoehorn."
* [Vim adventures](https://vim-adventures.com/)


## The history of vim

* [Vim creator Bram Moolenaar
    interview](https://www.binpress.com/vim-creator-bram-moolenaar-interview/)
> "The project I encountered in Kibaale is completely different. The foreigners
> who work there are volunteers, they have sponsors themselves to make it
> possible to live and work there. All the donations for children go to the
> project and are spent there. Also for staff and vehicles, but that’s local
> staff that then spend their money in the country, thus indirectly it helps
> others. And in the end seeing the children grow up, finish their studies and
> find a job is wonderful. "


---
title: "Vim Commands"
output: 
  html_document: 
    toc: yes
    toc_float: true
---

This page is the continuation of [my blog post on Vim commands](https://paulremote.blogspot.de/2014/07/vim-commands.html).

# Help

    :help  -  vim help
    :help commandname - help on a particular command
    :h commandname -help on a particular command
    CTRL+] - jump to a highlighted topic
    CTRL+T - jump backwards

[HTML version of the Vim help pages](http://vimhelp.appspot.com/)
kept up-to-date automatically from the 
[Vim source repository](https://github.com/vim/vim).

# Enter commands, save and quit

To enter edit mode:

    i

To enter command mode:

    escape

To exit vim, go in command mode and enter the following command:

    :q

To exit without saving the content of the file:

    :q!

To save the content of the file:

    :w

If you accidentally press CTRL+S the [terminal will hang](https://askubuntu.com/a/264253/315347)
Press `CTRL+Q` to regain control.
See also [Ctrl-s hang terminal emulator?](https://unix.stackexchange.com/questions/72086/ctrl-s-hang-terminal-emulator)
which provides a workaround: entering `stty -ixon` in .bashrc. 

To save content and exit:

    :wq

# Navigate

## Display line numbers
 Display line numbers

    :set nu

Disable line numbers

    :set nonu

Enter `:line number` to jump to a particular line number.

## Explore files

Vim comes with a file explorer:

    :E

or 

    :Explorer

## Jump back and forth

Vim wiki [jumping to previously visited
locations](https://vim.fandom.com/wiki/Jumping_to_previously_visited_locations)
> "Like a web browser, you can go back, then forward:"

    Press Ctrl-O to jump back to the previous (older) location.
    Press Ctrl-I (same as Tab) to jump forward to the next (newer) location. 

## Markdown

Display a list of first level header in a markdown document (found in quick markdown navigation/TOC)

    :g/^# /#

See also the markdown TOC extension for vim.

## Move up, down, left, right

In command mode, the following motions are activated:

    :help left-right-motion
    j,k move up down
    h,l move left right
    b,w move previous or next word
    ctrl+b, ctrl+d move page up or page down
    {number} G go to line number 

Note on motion with wrapped lines:
[Move cursor by display lines when wrapping](https://vim.fandom.com/wiki/Move_cursor_by_display_lines_when_wrapping)

## Quick fix window

Help 

    :help quickfix

## Search in a file 

Use "/" to search, then n forward and N backwards "*" to search for the word
under the cursor (you can also create a mapping to search for a selected text)

Use `:g/patter` to display a list of all search result in the document. 

## Search in multiple files

[open files on the match lines given by grep](https://stackoverflow.com/questions/2653419/vim-open-files-of-the-matches-on-the-lines-given-by-grep)

    :copen
    :grep -r pattern .

or specify specific files extensions

    :grep -r pattern *.py

Or use git grep with the fugitive plugin:

    :copen
    :Ggrep pattern

## Working directory

Display the present working directory

    :pwd

[Set working directory to the current file](http://vim.wikia.com/wiki/Set_working_directory_to_the_current_file) (for all windows):

    :cd %:p:h

Set working directory to the current file, for the current window only

    :lcd %:p:h

In these commands, % gives the name of the current file, %:p gives its full path, and %:p:h gives its directory (the "head" of the full path). 

Automatically change the working directory to the file currently edited

    set autochdir

# Configure vim in .vimrc
See also my vimrc file stored in [setup/.vimrc](setup/.vimrc).

Reload the configuration after editing it: 

    :so ~/.vimrc

Text colour.
Add syntax highlight to your .vimrc

    syntax enable

How to add a file extension to vim syntax highlight

    au BufNewFile,BufRead *.dump set filetype=sql

I used it to display markdown files as text files:

    au BufNewFile,BufRead *.md set filetype=txt

## AZERTY Keyboard

* SO [Configure vim for AZERTY keyboards](https://stackoverflow.com/questions/33245317/vim-and-azerty-keyboards)
* Reddit [AZERTY keymapping](https://www.reddit.com/r/vim/comments/2tvupe/azerty_keymapping/)

I mapped m to the end of line, maybe I should use m instead? 

    nnoremap m $

See also mapping below.

## Colour themes

Be sure to set terminal colour to 256 as explained in an answer
 to [a question on vi.stackexchange](https://vi.stackexchange.com/a/25310/6671)
and in the vim wiki [256 colors in vim](https://vim.fandom.com/wiki/256_colors_in_vim)

    set t_Co=256

* Slant [vim Theme gallery](https://www.slant.co/topics/480/~best-vim-color-schemes#1) 
* [Custom theme aurora](https://github.com/rafalbromirski/vim-aurora)

## Key mapping and shortcuts

See 

    :help map

Show all mappings including <leader> commands:

   :map

# Edit a file

## Undo redo

    u: undo last change (can be repeated to undo preceding commands)
    Ctrl-R: Redo changes which were undone (undo the undos). 
    Compare to '.' to repeat a previous change, at the current cursor position.
    Ctrl-R will redo a previously undone change, wherever the change occurred. 

## Switch between navigation and editing mode

    A - move to the end of the line and switch to editing mode 
    I - switch to editing mode at the current place
    Escape - switch to navigation mode
    alt+h alt+j alt+k alt+l - switch to navigation mode and move
    alt+: - switch to navigation mode and send a command

## Replace characters

Vim wiki on search and replace 
Find each occurrence of 'red' (in the current line only), and replace it with 'green':
    
    :s/red/green/g

The `s`command  means "substitute".
The `g` means "greedy", it will replace all occurences of the word on a line 
(not just the first occurence).

When [text is visually selected](http://vim.wikia.com/wiki/Search_and_replace_in_a_visual_selection),
press : to enter a command. The command line will automatically enter the range:

    :'<,'>

Then you can enter a replacement command such as `s/red/green/g` 
to replace each occurence of "red" with "green" 
in all lines of the visual selection. The command will appear as:

    :'<,'>s/red/green/g

Find each occurrence of 'red' in all lines (`%s`), and replace it with 'green'.

    :%s/red/green/g 

Find each occurence of foo but don't perform the replacement, only count the number of occurences

    :%s/foo/bar/n

To replace by a new line character, use \r instead of \n.
For example to insert a new line after each comma in a selection:

    :'<,'>s/,/,\r/g

You can use replacement to remove text. 
For example to [remove the last 2 characters of each line in a selection](https://stackoverflow.com/a/36264759/2641825) :

    :'<,'>s/..$//

Remove all beginnings of line. :%s/\option\n/, /g replace all end of line by comma + space. This cleans an html list of species for inclusion in a text.

     %s/option value=".*"//g 

## Remove unwanted spaces

[Remove unwanted spaces](https://vim.fandom.com/wiki/Remove_unwanted_spaces#Automatically_removing_all_trailing_whitespace)

## Edit a whole line

To edit a whole line: 

    dd to delete a whole line
    yy to copy a whole line
    p to paste the copied or deleted text after the current line or 
    P to paste the copied or deleted text before the current line 

## Edit multiple lines

You can edit multiple lines simultaneously by 
[inserting text inside a multi-line selection in Vim](https://stackoverflow.com/a/253391) :

    Use Ctrl+V to enter visual block mode
    Move down with jj to select the columns of text in the lines you want to comment.
    Then hit Shift+I and type the text you want to insert.
    Then press Escape, the inserted text will appear on all lines.
    
Similarly to enter text at the end of multiple lines ([vim.wikia](http://vim.wikia.com/wiki/Inserting_text_in_multiple_lines))

    Use Ctrl+V to enter visual block mode
    Move down with jj to select the columns of text in the lines you want to comment.
    Then hit $ to select all lines until the end of the line.
    Then press Shift+A and type the text you want to insert.
    The press Escape, the inserted text will appear at the end of all lines.

## Copy, cut and paste

Copy and paste with the following instructions

    Position the cursor where you want to begin cutting.
    Press v (or upper case V if you want to cut whole lines).
    Move the cursor to the end of what you want to cut.
    Press d to cut or y to copy.
    Move to where you would like to paste.
    Press P to paste before the cursor, or p to paste after. 

When pasting from the system register i.e. with `Ctrl+Shift+V` you need to prevent auto indent
otherwise vim will mess with the indentation. 
As explained in [Paste without autoindent](https://stackoverflow.com/a/2545242/2641825)
You can either read from the shell with:

    :r! cat 

And then paste `CTRL + SHIFT + V` the content, and `CTRL+D`.
Also works over SSH.

Or use

    :set paste
    :set nopaste

Set up a shortcut to toggle paste mode on and off with:

    set pastetoggle=<F3>


### Bracketed paste

[Enable bracketed paste in a session](https://stackoverflow.com/a/44507798/2641825)

    bind 'set enable-bracketed-paste on'    


## Indent

Indentation replaced by spaces, add this to the ~/.vimrc file

    set tabstop=4
    set expandtab
    set softtabstop=4
    set shiftwidth=4
    filetype indent on 

More details on vim indentation in the [python wiki](https://wiki.python.org/moin/Vim).

## Repeat Commands

[Repeating commands, Vim scripts and debugging](http://vimhelp.appspot.com/repeat.txt.html)

## Save file

save the current file

    :w

Save under a new name and edit that file

    :sav

SO [save as q new file qnd continue editing the original one](https://stackoverflow.com/questions/4980168/how-to-save-as-a-new-file-and-keep-working-on-the-original-one-in-vim)

## Wrap lines

Thoughtbot.com [Wrap existing block of text to 80 characters](https://thoughtbot.com/blog/wrap-existing-text-at-80-characters-in-vim):

    :set textwidth=80

Apply automatically to markdown files, by adding this to .vimrc 

    au BufRead,BufNewFile *.md setlocal textwidth=80

To format the text, select it with v and up or down movements, and press 

    gq

# Multiple files, buffers and windows

## Buffers

    :e filename - edit another file 
    :ls         - show current buffers
    :b 2        - open buffer #2 in this window
    :b filename - open buffer #filename in this window
    :bd         - close the current buffer (! to forget changes)
    :bd filename -close a buffer by name 

## Tabs should be called workspaces

[Why do vim experts prefer buffers over tabs?](https://stackoverflow.com/questions/26708822/why-do-vim-experts-prefer-buffers-over-tabs/26710166#26710166)
> ""Vim experts" don't prefer buffers over tabs: they use buffers as the file
> proxies they are and tab pages as the workspaces they are. Buffers and tab
> pages have different purposes"

## Window split

    :sp[lit] filename  - split window and load another file
    :10sp - specify the split height with a number
    :vs[plit] - same but split vertically  
    ctrl-w up arrow - move cursor up a window
    ctrl-w ctrl-w   - move cursor to another window (cycle)
    ctrl-w_         - maximize current window
    ctrl-w=         - make all equal size
    CTRL+z - suspend the process and get back to the shell
    fg - get back to vim

[Easier split navigations](https://robots.thoughtbot.com/vim-splits-move-faster-and-more-naturally#easier-split-navigations)

    nnoremap <C-J> <C-W><C-J>
    nnoremap <C-K> <C-W><C-K>
    nnoremap <C-L> <C-W><C-L>
    nnoremap <C-H> <C-W><C-H> 

Natural split opening

    set splitbelow
    set splitright

## Vim and Tmux

See the [bash](bash.html) page for the tmux side of the configuration.

[vim-tmux-navigator to use tmux prefix instead of C-[hjkl]](https://superuser.com/questions/1467829/vim-tmux-navigator-to-use-tmux-prefix-instead-of-c-hjkl)

busnag.com [tmux and vim](https://www.bugsnag.com/blog/tmux-and-vim)
> " like many vim users, I edited my .vimrc to simplify split navigation, so
> that I can jump between vim splits using ctrl-j, ctrl-k, etc. 

reddit [python workflow with terminal using tmux](https://www.reddit.com/r/vim/comments/chdl60/python_workflow_with_terminal_using_tmux/)
> "Finally, I have Ctrl+[hjkl] setup such that I can navigate seamlessly between vim and tmux panes."


# Plugins

Plugins are mentioned in diverse section of this document. 
This section is mostly to list plugins I used and potentially interesting plugins. 

Plugins I currently use with vundle: 

    :PluginList
    Plugin 'VundleVim/Vundle.vim'
    Plugin 'godlygeek/tabular'
    Plugin 'plasticboy/vim-markdown'
    Plugin 'tpope/vim-fugitive'
    Plugin 'davidhalter/jedi-vim'

I also use a spell checker. 

Other plugins installed in the default vim repo:

    :r ! ls ~/.vim/pack/plugins/start/
    vim-slime
    vim-tmux-navigator

Potentially useful plugins

* [fugitive](https://github.com/tpope/vim-fugitive) git integration
* Fuzzy search 
* fzf command line fuzzy finder [fzf](https://github.com/junegunn/fzf)
* File explorer 
    * or simply use the native vim explorer `:Explore`
* Minibufexplorer and SO post on [alternatives to minibufexplorer](https://stackoverflow.com/questions/4865132/an-alternative-to-minibufexplorer-vim)
* [Vimtex](https://github.com/lervag/vimtex#alternatives) 
  vim plugin for editing LaTeX files. 
* [distribution spf13](https://vim.spf13.com/) probably not recommended but the home page contains a list of interesting plugins. 
*
See also the section programming with vim below for language specific plugins. 

## Installing plugins with vim's built-in plugin support

Install slime with Vim's built-in package support (since Vim 7.4.1528):

     mkdir -p ~/.vim/pack/plugins/start
     cd ~/.vim/pack/plugins/start
     git clone https://github.com/jpalardy/vim-slime.git

## Installing plugins with Vundle

Since there is a built-in plugin support, maybe I don't need Vundle after all? 

Edit your .vimrc and add the following at the beginning

    set nocompatible              " be iMproved, required
    filetype off                  " required

    " set the runtime path to include Vundle and initialize
    set rtp+=~/.vim/bundle/Vundle.vim
    call vundle#begin()
    " alternatively, pass a path where Vundle should install plugins
    "call vundle#begin('~/some/path/here')

    " let Vundle manage Vundle, required
    Plugin 'VundleVim/Vundle.vim'
    " Navigate markdown toc
    Plugin 'godlygeek/tabular'
    Plugin 'plasticboy/vim-markdown'
    Plugin 'tpope/vim-fugitive'
    Plugin 'jpalardy/vim-slime'

    " All of your Plugins must be added before the following line
    call vundle#end()            " required
    filetype plugin indent on    " required
    " To ignore plugin indent changes, instead use:
    "filetype plugin on
    "
    " Brief help
    " :PluginList       - lists configured plugins
    " :PluginInstall    - installs plugins; append `!` to update or just :PluginUpdate
    " :PluginSearch foo - searches for foo; append `!` to refresh local cache
    " :PluginClean      - confirms removal of unused plugins; append `!` to auto-approve removal
    "
    " see :h vundle for more details or wiki for FAQ
    " Put your non-Plugin stuff after this line


Install all plugins configured in your `.vimrc`.

    :PluginInstall

# Programming with vim

## Debugging

vi.stackexchange [Python debugging](https://vi.stackexchange.com/questions/17962/python-debugging)
[vimpdb](https://github.com/gotcha/vimpdb)

## Linter

I have installed the [ALE linter](https://github.com/dense-analysis/ale) and use it for python code.
To temporarily disable ALE in a buffer:

    :let b:ale_enabled = 0

To enable it:

    :let b:ale_enabled = 1

For the python options, see:

    :h ale-python-options

I've added this option to my .vimrc to show which linter is complaining

    let g:ale_echo_msg_format = '[%linter%] %s'

The linters I see most in python code are pylint and flake8.

Pylint complains about [variable names that are too short](https://github.com/PyCQA/pylint/issues/2018)

## Navigate code

Install exhuberant ctags 

    sudo apt install ctags

Install the taglist plugin with vundle

    Plugin 'yegappan/taglist'

[taglist manual](http://vim-taglist.sourceforge.net/manual.html#taglist-internet)

> "You can open the taglist window using the ":TlistOpen" or the ":TlistToggle"
> commands. The ":TlistOpen" command opens the taglist window and jumps to it.
> The ":TlistToggle" command opens or closes (toggle) the taglist window and the
> cursor remains in the current window."

## Python programming with vim

Plugins
* [Python mode](https://github.com/python-mode/python-mode)
* [Jedi](https://github.com/python-mode/python-mode) it's incompatible with python mode (according to the readme)
    * more explanations in the Jedi section below
* [vim ipython](https://github.com/ivanov/vim-ipython)
* [vim-test] see also the tests section below.

Blog posts

* wiki.python.org [vim](https://wiki.python.org/moin/Vim) mentions:
    * [vim as a python IDE](https://200ok.ch/posts/vim-as-python-ide.html)
* realpython.com [Vim and python a match made in heaven](https://realpython.com/vim-and-python-a-match-made-in-heaven/)
* reddit [python-mode or Jedi?](https://www.reddit.com/r/Python/comments/5f2fri/developing_python_with_vim_what_plugin_to_choose/)
     python mode seems to be for starting, most people turn the features off.
* SO [Running python code in VIM](https://stackoverflow.com/questions/18948491/running-python-code-in-vim)
Make sure your files start with a shebang.
* Plug-in [Jupyter vim](https://github.com/jupyter-vim/jupyter-vim)
* Vim on Python wiki (set softtabstop=4) or your  python development environment (set tabstop=4 and set softtabstop=4)
* full stack python [vim](https://www.fullstackpython.com/vim.html)
* [vim and python script debugging](https://stackoverflow.com/questions/1901528/vim-and-python-scripts-debugging)

Reddit [python workflow with terminal using tmux](https://www.reddit.com/r/vim/comments/chdl60/python_workflow_with_terminal_using_tmux/)

> "I run my scripts using
> 
> ipython -i script.py
> 
> That way I drop to an ipython shell whenever it breaks or finishes running. I also insert
> 
> from ipython import embed; embed();
> 
> Instead of using pdb. Its really neat."

### Jedi vim

* [Jedi](https://github.com/davidhalter/jedi) autocompletion, also used by
    ipython.
* [Jedi vim
    documentation](https://github.com/davidhalter/jedi-vim/blob/master/doc/jedi-vim.txt)

Jedi Installation required enabling python mode in vim, available inside this
Debian package:

    sudo apt install vim-nox

Autocomplete is turned on to complete a word, press:

    Ctrl+Space

To cycle through proposition you can use `Ctrl+space` again or:

    Ctrl+P
    Ctrl+N

Enter for example a module name, then use Ctrl+N and
Ctrl+P to choose among the objects and functions in that module. 

Jump to definition:

    <leader>d

I remapped the `<leader>` key to `,` in my .vimrc

    :let mapleader = ","

See above section on navigation, you can use `Ctrl-O` to jump back and
`Ctrl-I`to jump forward.

## R programming with vim

[Turning vim into an
IDE](https://www.freecodecamp.org/news/turning-vim-into-an-r-ide-cd9602e8c217/)

Uses [Nvim-R](https://github.com/jalvesaq/Nvim-R)
which works with both vim and neo vim

## Send code to target terminal

[vim slime](https://github.com/jpalardy/vim-slime)
> "Grab some text and send it to a target, most probably: GNU Screen, tmux or Vim Terminal"

Tmux is not the default, to use it you will have to add this line to your .vimrc:

    let g:slime_target = "tmux"

Then add this to configure the sending of commands to a 
[Read Eval Print Loop](https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop):
in the general use case of
vim in a split tmux window with a REPL in the other pane:

    let g:slime_default_config = {"socket_name": "default", "target_pane": "{last}"}

## Tests

[Vim Test](https://github.com/vim-test/vim-test)
Works with pytest and many other testing suites for many languages.
Test results appear in the quick fix window.

[pytest vim](https://github.com/alfredodeza/pytest.vim)
Run pytest from within vim. 

# Tools

## Shell

[Working with external commands](https://www.linux.com/learn/vim-tips-working-external-commands)
explains how to start a shell:

    :shell

Then exit the shell normaly with `exit`.

Use a Bang! to run a command directly, for example to
see how many words are in the file, run:

    :! wc %

You can copy (`y $`) and paste a command in the vim command line with `CTRL + R + "`.

Insert text from a specified file into the current buffer:

    :r textfile

You can also read in the output of shell applications. For example, if you wanted to include a list of files from a specific directory, you could include them using this read command:

    :r ! ls -1 /home/user/directory

## Vim diff

View differences between `file1` and `file2` (vim documentation)

    vimdiff file1 file2

## spell check

[How to configure vim spellcheck to use two languages](https://superuser.com/questions/911412/how-to-configure-vim-spellcheck-to-use-two-languages)
To use the spellcheck for two languages, add this to your `~/.vimrc`:

    set spell spelllang=en_gb,fr

On the first use, vim may give a warning that some word lists are missing. 
[How to make vim download missing word lists](https://www.monolune.com/how-to-make-vim-download-missing-word-lists/)
To solve this issue, turn spell check off

    :set nospell 

Turn spell check on

    :set spell

Then vim will offer to download the missing dictionaries. 

Set spell check only in the local buffer:

    :setlocal spell spelllang=en_gb   

Find alternative for highlighted word:

    z=

[How to make vim spell check remember a word](https://superuser.com/questions/133208/how-to-make-vim-spellcheck-remember-a-new-word)
Mark word as correct, this creates a spell file under /home/user/.vim/spell:

    zg 

Mark word as incorrect

    zw



# blogs

[Why atom cant replace vim](https://medium.com/@mkozlows/why-atom-cant-replace-vim-433852f4b4d1)

> "This philosophy of minimalist commands that can be composed together is the
> fundamental originating philosophy of Unix, and Vim exemplifies it like no
> other editor."

reddit [Python workflow with terminal using tmux](https://www.reddit.com/r/vim/comments/chdl60/python_workflow_with_terminal_using_tmux/)
I tried slime.

[Jupyter vim](https://github.com/jupyter-vim/jupyter-vim)
[Browse the web in vim mode](https://github.com/tridactyl/tridactyl)

## Learning vim
* [Should I introduce vim tomy kid](https://www.reddit.com/r/vim/comments/aak1lf/should_i_introduce_vim_to_my_kid/)
> "Learn to support, not to shoehorn."
* [Vim adventures](https://vim-adventures.com/)
* [Learn vim basic featurs](https://www.freecodecamp.org/news/learn-linux-vim-basic-features-19134461ab85/)

## The history of vim

* [Vim creator Bram Moolenaar
    interview](https://www.binpress.com/vim-creator-bram-moolenaar-interview/)
> "The project I encountered in Kibaale is completely different. The foreigners
> who work there are volunteers, they have sponsors themselves to make it
> possible to live and work there. All the donations for children go to the
> project and are spent there. Also for staff and vehicles, but that’s local
> staff that then spend their money in the country, thus indirectly it helps
> others. And in the end seeing the children grow up, finish their studies and
> find a job is wonderful. "

